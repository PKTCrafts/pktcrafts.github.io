<script>
  window.addEventListener('DOMContentLoaded', () => {
    const SUPABASE_URL = "https://ieoyoqkeiiooxgxorusu.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...";
    const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    window.signUp = async function () {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const { error } = await client.auth.signUp({ email, password });
      document.getElementById('user-info').textContent = error ? error.message : "Registered! Please check your email to confirm.";
    }

    window.signIn = async function () {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const { data, error } = await client.auth.signInWithPassword({ email, password });

      if (error) {
        document.getElementById('user-info').textContent = error.message;
      } else {
        const userId = data.user.id;

        const { data: player, error: playerError } = await client
          .from('players')
          .select('*')
          .eq('id', userId)
          .single();

        if (playerError) {
          document.getElementById('user-info').textContent = "Login successful, but no player data found.";
        } else {
          document.getElementById('user-info').innerHTML = `
            <p>âœ… Logged in as: ${data.user.email}</p>
            <p><strong>Nickname:</strong> ${player.nickname}</p>
            <p><strong>Rating:</strong> ${player.rating}</p>
            <p><strong>Kills:</strong> ${player.kills}</p>
            <p><strong>Deaths:</strong> ${player.deaths}</p>
            <p><strong>Coins:</strong> ${player.coins}</p>
          `;
        }
      }
    }
  });
</script>
